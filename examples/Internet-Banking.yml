# Colocar sizing nas imagens
# Colocar sizing nos scripts

# the global configuration allows you to turn on specific features
global:
  machine: true
  netviz: false
  loaders: true
  services: true
  chaos: true
  dbmon: false

apm:
  applicationName: Internet-Banking
  eum:
    appKey: AD-AAB-ABE-UHE

services:
  web-front-end:
    type: java
    agent: yes
    port: 3000
    aliases:
      - www.internet-banking.appd
    endpoints:
      http:
        /home:
          - log,info,Home
          - http://auth.appd/check-session
          # - image,http://cdn.cloud/logo.png
          # - image,http://cdn.cloud/banner.png
          # - script,http://google.com/ga.js
          # - ajax,http://external.service.cloud/quote/dollar
          # - ajax,http://internal.service.cloud/checkversion.js

  auth:
    type: java
    agent: yes
    aliases:
      - auth.appd
    endpoints:
      http:
        /check-session:
          - call: sql://backend-db/internetbanking?query=SELECT * FROM users WHERE id = 1
            remoteTimeout: 1
          # - slow,512
          - call: slow,2048
            probability: 0.50
          # - call: error,500,Session Expired
          #   probability: 0.10

  cdn.cloud:
    type: nodejs
    agent: no
    aliases:
      - google.com
      - external.service.cloud
      - internal.service.cloud
    endpoints:
      http:
        /logo.png:
          - sleep,100
          - call: sleep,1200
            probability: 0.2
        /banner.png:
          - sleep,130
          - call: sleep,900
            probability: 0.5
        /ga.js:
          - sleep,100
          - call: sleep,1600
            probability: 0.5
        /checkversion.js:
          - sleep,64
          - call: sleep,256
            probability: 0.2
        /quote/dollar:
          - sleep,128
          - call: sleep,800
            probability: 0.30

  backend-db:
    type: mysql
    databases:
      internetbanking:
        users: [id, first_name, last_name, email, brand, account, segment]
        statement: [id, brand, account, type, value]

loaders:
  user-geral:
    type: puppeteer
    wait: 60
    count: 1
    devices: ["iPhone 11 Pro Max", "Galaxy S5", "iPad Pro landscape", "iPhone 8", "Nexus 6P", "Pixel 2 XL", "Microsoft Lumia 950"]
    locations:
      - { city: "San Francisco", region: "California", country: "United States" }
      - { city: "Brasilia", region: "Distrito Federal", country: "Brazil" }
      - { city: "Ipatinga", region: "Minas Gerais", country: "Brazil" }
      - { city: "Rio de Janeiro", region: "Rio de Janeiro", country: "Brazil" }
      - { city: "Manaus", region: "Amazonas", country: "Germany" }
      - { city: "Tokyo", region: "Kanto", country: "Japan" }
      - { city: "Sapporo", region: "Hokkaido", country: "Japan" }
      - { city: "Fedotyev", region: "Kamchatka", country: "Russian Federation" }
      - { city: "Frankfurt", region: "Hessen", country: "Germany" }
    urls:
      - http://www.internet-banking.appd/home
