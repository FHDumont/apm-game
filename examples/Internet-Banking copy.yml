# Colocar sizing nas imagens
# Colocar sizing nos scripts

# the global configuration allows you to turn on specific features
global:
  machine: true
  netviz: false
  loaders: true
  services: true
  chaos: true
  dbmon: false

apm:
  applicationName: Internet-Banking
  eum:
    appKey: AD-AAB-ABE-UHE

services:
  web-front-end:
    type: java
    agent: yes
    port: 3000
    aliases:
      - www.internet-banking.appd
    endpoints:
      http:
        /home:
          - log,info,Home
          # - http://auth.appd/check-session
          # - image,http://cdn.cloud/logo.png
          # - image,http://cdn.cloud/banner.png
          # - script,http://google.com/ga.js
          # - ajax,http://external.service.cloud/quote/dollar
          # - ajax,http://internal.service.cloud/checkversion.js
        /login:
          - http://auth.appd/login
          - http://auth.appd/ping
        /logout:
          - http://auth.appd/logout
        /ping:
          - log,info,Ping
          - slow,1024
          - call: error,500,ping-error
            probability: 0.1
        /conta-corrente/extrato:
          - log,info,default-log
          - http://conta-corrente.appd/extrato
        /conta-corrente/saldo:
          - log,info,default-log
          - http://conta-corrente.appd/saldo
        /transacao/fazer-transferencia:
          - log,info,default-log
          - http://transacao.appd/fazer-transferencia
        /transacao/pagar-boleto:
          - log,info,default-log
          - http://transacao.appd/pagar-boleto
        /transacao/listar-dda:
          - log,info,default-log
          - http://transacao.appd/listar-dda
        /pix/minhas-chaves:
          - log,info,default-log
          - http://pix.appd/minhas-chaves
        /pix/extrato:
          - log,info,default-log
          - http://pix.appd/extrato
        /pix/transferir:
          - log,info,default-log
          - http://pix.appd/transferir
        /pix/pagar-qr-code:
          - log,info,default-log
          - http://pix.appd/pagar-qr-code
        /pix/gerar-qr-code:
          - log,info,default-log
          - http://pix.appd/gerar-qr-code
        /cartao/listar:
          - log,info,default-log
          - http://cartao.appd/listar
        /cartao/extrato:
          - log,info,default-log
          - http://cartao.appd/extrato
        /cartao/cartao-virtual:
          - log,info,default-log
          - http://cartao.appd/cartao-virtual
        /cartao/aumento-limite:
          - log,info,default-log
          - http://cartao.appd/aumento-limite
        /investimento/extrato:
          - log,info,default-log
          - http://investimento.appd/extrato
        /investimento/aplicar:
          - log,info,default-log
          - http://investimento.appd/aplicar
        /investimento/resgatar:
          - log,info,default-log
          - http://investimento.appd/resgatar
        /poupanca/extrato:
          - log,info,default-log
          - http://poupanca.appd/extrato
        /poupanca/aplicar:
          - log,info,default-log
          - http://poupanca.appd/aplicar
        /poupanca/resgatar:
          - log,info,default-log
          - http://poupanca.appd/resgatar
        /emprestimo/listar:
          - log,info,default-log
          - http://emprestimo.appd/listar
        /emprestimo/pedir:
          - log,info,default-log
          - http://emprestimo.appd/pedir
        /emprestimo/pagar:
          - log,info,default-log
          - http://emprestimo.appd/pagar

  auth:
    type: java
    agent: yes
    aliases:
      - auth.appd
    endpoints:
      http:
        /ping:
          - log,info,Ping
          - slow,1024
        /login:
          - log,info,Login
          - slow,1024
          - call: error,500,Forbidden
            probability: 0.1
        /logout:
          - log,info,Logout
          - slow,512
        /check-session:
          - sql://backend-db/internetbanking?query=SELECT * FROM users WHERE id = 1
          - slow,512
          - call: slow,1024
            probability: 0.25
          - call: error,500,Session Expired
            probability: 0.10

  # conta-corrente:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - conta-corrente.appd
  #   endpoints:
  #     http:
  #       /extrato:
  #         - slow,512
  #       /saldo:
  #         - slow,512

  # transacao:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - transacao.appd
  #   endpoints:
  #     http:
  #       /fazer-transferencia:
  #         - slow,512
  #       /listar-dda:
  #         - slow,512
  #       /pagar-boleto:
  #         - slow,512

  # pix:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - pix.appd
  #   endpoints:
  #     http:
  #       /minhas-chaves:
  #         - slow,512
  #       /extrato:
  #         - slow,512
  #       /transferir:
  #         - slow,512
  #       /pagar-qr-code:
  #         - slow,512
  #       /gerar-qr-code:
  #         - slow,512

  # cartao:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - cartao.appd
  #   endpoints:
  #     http:
  #       /listar:
  #         - slow,512
  #       /extrato:
  #         - slow,512
  #       /cartao-virtual:
  #         - slow,512
  #       /aumento-limite:
  #         - slow,512

  # investimento:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - investimento.appd
  #   endpoints:
  #     http:
  #       /extrato:
  #         - slow,512
  #       /aplicar:
  #         - slow,512
  #       /resgatar:
  #         - slow,512

  # poupanca:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - poupanca.appd
  #   endpoints:
  #     http:
  #       /extrato:
  #         - slow,512
  #       /aplicar:
  #         - slow,512
  #       /resgatar:
  #         - slow,512

  # emprestimo:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - emprestimo.appd
  #   endpoints:
  #     http:
  #       /listar:
  #         - slow,512
  #       /pedir:
  #         - slow,512
  #       /pagar:
  #         - slow,512

  # sap:
  #   type: nodejs
  #   agent: no
  #   aliases:
  #     - sap.appd
  #   endpoints:
  #     http:
  #       /ping:
  #         - slow,512

  cdn.cloud:
    type: nodejs
    agent: no
    aliases:
      - google.com
      - external.service.cloud
      - internal.service.cloud
    endpoints:
      http:
        /logo.png:
          - sleep,100
          - call: sleep,1200
            probability: 0.2
        /banner.png:
          - sleep,130
          - call: sleep,900
            probability: 0.5
        /ga.js:
          - sleep,100
          - call: sleep,1600
            probability: 0.5
        /checkversion.js:
          - sleep,64
          - call: sleep,256
            probability: 0.2
        /quote/dollar:
          - sleep,128
          - call: sleep,800
            probability: 0.30

  backend-db:
    type: mysql
    databases:
      internetbanking:
        users: [id, first_name, last_name, email, brand, account, segment]
        statement: [id, brand, account, type, value]

loaders:
  # user-conta-corrente:
  #   type: puppeteer
  #   wait: 60
  #   count: 1
  #   urls:
  #     - http://www.internet-banking.appd/home
  #     - http://www.internet-banking.appd/login
  #     - http://www.internet-banking.appd/home
  #     - http://www.internet-banking.appd/conta-corrente/extrato
  #     - http://www.internet-banking.appd/conta-corrente/saldo
  #     - http://www.internet-banking.appd/logout

  # user-transacao:
  #   type: puppeteer
  #   wait: 60
  #   count: 1
  #   urls:
  #     - http://www.internet-banking.appd/login
  #     - http://www.internet-banking.appd/transacao/extrato
  #     - http://www.internet-banking.appd/transacao/pagar-boleto
  #     - http://www.internet-banking.appd/transacao/extrato
  #     - http://www.internet-banking.appd/transacao/fazer-transferencia
  #     - http://www.internet-banking.appd/transacao/listar-dda
  #     - http://www.internet-banking.appd/transacao/pagar-boleto
  #     - http://www.internet-banking.appd/home

  # user-pix:
  #   type: puppeteer
  #   wait: 30
  #   count: 1
  #   locations:
  #     - { city: "San Francisco", region: "California", country: "United States" }
  #     - { city: "Brasilia", region: "Distrito Federal", country: "Brazil" }
  #     - { city: "Ipatinga", region: "Minas Gerais", country: "Brazil" }
  #   urls:
  #     - http://www.internet-banking.appd/home
  #     - http://www.internet-banking.appd/login
  #     - http://www.internet-banking.appd/home
  #     - http://www.internet-banking.appd/pix/minhas-chaves
  #     - http://www.internet-banking.appd/pix/extrato
  #     - http://www.internet-banking.appd/pix/transferir
  #     - http://www.internet-banking.appd/pix/gerar-qr-code
  #     - http://www.internet-banking.appd/pix/pagar-qr-code
  #     - http://www.internet-banking.appd/pix/extrato

  user-geral:
    type: puppeteer
    wait: 30
    count: 1
    devices: ["iPhone 11 Pro Max", "Galaxy S5", "iPad Pro landscape", "iPhone 8", "Nexus 6P", "Pixel 2 XL", "Microsoft Lumia 950"]
    locations:
      - { city: "San Francisco", region: "California", country: "United States" }
      - { city: "Brasilia", region: "Distrito Federal", country: "Brazil" }
      - { city: "Ipatinga", region: "Minas Gerais", country: "Brazil" }
      - { city: "Rio de Janeiro", region: "Rio de Janeiro", country: "Brazil" }
      - { city: "Manaus", region: "Amazonas", country: "Germany" }
      - { city: "Tokyo", region: "Kanto", country: "Japan" }
      - { city: "Sapporo", region: "Hokkaido", country: "Japan" }
      - { city: "Fedotyev", region: "Kamchatka", country: "Russian Federation" }
      - { city: "Frankfurt", region: "Hessen", country: "Germany" }
    urls:
      - http://www.internet-banking.appd/home
      # - http://www.internet-banking.appd/login
      # - http://www.internet-banking.appd/home
      # - http://www.internet-banking.appd/conta-corrente/saldo
      # - http://www.internet-banking.appd/transacao/pagar-boleto
      # - http://www.internet-banking.appd/pix/extrato
      # - http://www.internet-banking.appd/cartao/listar
      # - http://www.internet-banking.appd/cartao/cartao-virtual
      # - http://www.internet-banking.appd/investimento/extrato
      # - http://www.internet-banking.appd/poupanca/aplicar
      # - http://www.internet-banking.appd/emprestimo/pagar
      # - http://www.internet-banking.appd/logout
